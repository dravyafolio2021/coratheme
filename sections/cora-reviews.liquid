{% comment %}
  ✅ Optimized Cora Reviews (Zenmies)
  Lean version — Custom SVG center, no review blocks, only gallery and summary.
{% endcomment %}

<section id="cora-reviews-{{ section.id }}" class="cora-reviews">
  <div class="cora-reviews__inner container">
    {% if section.settings.heading != blank %}
      <h2 class="cora-reviews__heading" style="color: {{ section.settings.heading_color }};">
        {{ section.settings.heading }}
      </h2>
    {% endif %}

    <!-- Ratings Summary Section -->
    <div class="cora-reviews__summary">
      <!-- Left: Overall Score -->
      <div class="cora-reviews__left">
        <div class="cora-reviews__score">
          <span class="cora-reviews__rating-value">{{ section.settings.avg_rating }}</span>
          <div class="cora-reviews__stars" style="--star-color: {{ section.settings.star_color }};">
            {% assign avg_rating_num = section.settings.avg_rating | plus: 0 %}
            {% for i in (1..5) %}
              {% if i <= avg_rating_num %}
                ★ 
              {% else %}
                ☆
              {% endif %}
            {% endfor %}
          </div>
          <span class="cora-reviews__count">{{ section.settings.total_reviews }} reviews</span>
        </div>
      </div>

      <!-- Center: Custom SVG -->
      <div class="cora-reviews__center">
        {% if section.settings.custom_svg != blank %}
          <div class="cora-reviews__svg">
            {{ section.settings.custom_svg }}
          </div>
        {% else %}
          <div class="cora-reviews__svg--placeholder">
            <svg width="100" height="100" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
              <circle cx="50" cy="50" r="48" stroke="#e5e3ed" stroke-width="3" fill="none" />
              <text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" fill="#6B45E6" font-size="12">
                Add SVG
              </text>
            </svg>
          </div>
        {% endif %}
      </div>

      <!-- Right: Write Review CTA -->
      <div class="cora-reviews__right">
        <p>Share your experience</p>
        <div class="cora-reviews__stars small">★★★★★</div>
        {% if section.settings.cta_label != blank %}
          <a href="{{ section.settings.cta_url | default: '#' }}" class="cora-reviews__button">
            {{ section.settings.cta_label }}
          </a>
        {% endif %}
      </div>
    </div>

    <!-- Gallery (as blocks) -->
    {% assign gallery_blocks = section.blocks | where: 'type', 'gallery_image' %}
    {% if gallery_blocks.size > 0 %}
      <div class="cora-reviews__gallery">
        {% for block in gallery_blocks %}
          {% if block.settings.image != blank %}
            <img src="{{ block.settings.image | image_url: width: 300 }}" alt="Customer photo" loading="lazy">
          {% endif %}
        {% endfor %}
      </div>
    {% endif %}

    {% comment %} {% if section.settings.show_cta_button %}
      <div class="cora-reviews__more">
        <a href="{{ section.settings.more_url | default: '#' }}" class="cora-reviews__more-btn">
          {{ section.settings.more_label }}
        </a>
      </div>
    {% endif %} {% endcomment %}
  </div>
</section>

{{ 'cora-reviews.css' | asset_url | stylesheet_tag }}

{% schema %}
{
  "name": "Cora Reviews (Summary)",
  "class": "cora-section cora-reviews",
  "settings": [
    { "type": "text", "id": "heading", "label": "Section Heading", "default": "Customer Reviews" },
    { "type": "color", "id": "heading_color", "label": "Heading Color", "default": "#160E26" },

    { "type": "text", "id": "avg_rating", "label": "Average Rating", "default": "4.8" },
    { "type": "text", "id": "total_reviews", "label": "Total Reviews", "default": "817" },
    { "type": "color", "id": "star_color", "label": "Star Color", "default": "#6B45E6" },

    {
      "type": "textarea",
      "id": "custom_svg",
      "label": "Custom SVG Code",
      "info": "Paste your SVG markup here. Example: <svg>...</svg>"
    },

    { "type": "text", "id": "cta_label", "label": "CTA Label", "default": "WRITE A REVIEW" },
    { "type": "url", "id": "cta_url", "label": "CTA URL" },

    { "type": "checkbox", "id": "show_cta_button", "label": "Show 'See More Reviews' Button", "default": true },
    { "type": "text", "id": "more_label", "label": "See More Button Label", "default": "SEE MORE REVIEWS" },
    { "type": "url", "id": "more_url", "label": "See More Button URL" }
  ],
  "blocks": [
    {
      "type": "gallery_image",
      "name": "Gallery Image",
      "settings": [{ "type": "image_picker", "id": "image", "label": "Upload Gallery Image" }]
    }
  ],
  "presets": [{ "name": "Cora Reviews (Summary)", "category": "Zenmies" }]
}
{% endschema %}
